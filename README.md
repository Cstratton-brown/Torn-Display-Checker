# Torn-Display-Checker
Code written in Javascript intended to be used as a google Apps Script addition to a spreadsheet for the tracking of flowers, plushies and artifacts for the text based MMO Torn. The main intedned use for this is to track and record the contribution of multiple users in preperation for the yearly Museum Day Event. The code is designed based on a max group of 20 although this amount can be extended easily both on the spreadsheet and the within the code. The spreadsheet also includes a page for the distribution of points designed in such a way that everyone gets at a minimum the amount of points from the sets of flowers, plushies and artifcats that they have contributed, any leftover sets made up from all the leftover items are then distributed equally between all participants.

## Spreadsheet
This is a link to a copy of the spreadsheet which this code is intended to be used with through google sheets and the code ran through the google apps script.
https://docs.google.com/spreadsheets/d/1fPa3fs6Tmr7NntmbCqc98M8lM-Rsbs37cJbz2HoehXk/edit?usp=sharing.

## How to Use
First make a copy of the spreadsheet provided above, next select extensions > App Script, this will create an empty google scripts project linked to the spreadsheet. After the project has been created copy the code within checkDisplay.gs into the first code file, this is Code.gs by default although you can rename it. Next you will need to add a HTML file within which you copy the contents of item_reference.json.html, for this to work the html will need to be renamed to item_reference.json.html from the default name. After this is done go through and replace the line torn_api_key with your own torn api key, with the exception of checkEvents() which needs a full acces key all that is needed is a public level API key. checkEvents() isnt essential to this script unless you wish to have people joining or leaving automated, this is done through checking your personal logs hence the full acess api key being needed. Next if you wish to enable discord notification then tallyChanges() variable discordURL requires a discord webbhook url to the channel you would like the notifications to be sent to. After this is done all that is left to do is go to the userReference page on the spreadsheet and ensure the ID and username collumns contain all the users participating, the values in the row collumn MUST start at 3 and increase by 1 each new row in order for values to be inserted correctly. Finally just set up a trigger through the google scripts to run checkDisplay() as frequently as you would like the spreadsheet to be updated, i would reccomend atleast once every 24 hours. If you choose to use the checkEvents() to automate people joining and leaving that will also need to be set on a timer as it is assumed you will be checking events more frequently than updating the spreadsheet, by default it checks for a money received event containg the  mesage "museum join" and "museum leave" to join and leave respectively, it is not case sensative but will not accept messages that contain this along with extra words.
